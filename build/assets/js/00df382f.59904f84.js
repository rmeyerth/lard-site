"use strict";(self.webpackChunklarf_site=self.webpackChunklarf_site||[]).push([[2140],{5680:(e,n,t)=>{t.d(n,{xA:()=>c,yg:()=>g});var a=t(6540);function o(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function r(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function i(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?r(Object(t),!0).forEach((function(n){o(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):r(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function s(e,n){if(null==e)return{};var t,a,o=function(e,n){if(null==e)return{};var t,a,o={},r=Object.keys(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var l=a.createContext({}),u=function(e){var n=a.useContext(l),t=n;return e&&(t="function"==typeof e?e(n):i(i({},n),e)),t},c=function(e){var n=u(e.components);return a.createElement(l.Provider,{value:n},e.children)},p="mdxType",d={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},m=a.forwardRef((function(e,n){var t=e.components,o=e.mdxType,r=e.originalType,l=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),p=u(t),m=o,g=p["".concat(l,".").concat(m)]||p[m]||d[m]||r;return t?a.createElement(g,i(i({ref:n},c),{},{components:t})):a.createElement(g,i({ref:n},c))}));function g(e,n){var t=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var r=t.length,i=new Array(r);i[0]=m;var s={};for(var l in n)hasOwnProperty.call(n,l)&&(s[l]=n[l]);s.originalType=e,s[p]="string"==typeof e?e:o,i[1]=s;for(var u=2;u<r;u++)i[u]=t[u];return a.createElement.apply(null,i)}return a.createElement.apply(null,t)}m.displayName="MDXCreateElement"},3846:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>i,default:()=>d,frontMatter:()=>r,metadata:()=>s,toc:()=>u});var a=t(8168),o=(t(6540),t(5680));const r={sidebar_position:7},i="System Functions",s={unversionedId:"toolkit/system-functions",id:"toolkit/system-functions",title:"System Functions",description:"System Functions",source:"@site/docs/toolkit/system-functions.md",sourceDirName:"toolkit",slug:"/toolkit/system-functions",permalink:"/docs/toolkit/system-functions",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/toolkit/system-functions.md",tags:[],version:"current",sidebarPosition:7,frontMatter:{sidebar_position:7},sidebar:"tutorialSidebar",previous:{title:"Processor",permalink:"/docs/toolkit/processor"},next:{title:"Operators",permalink:"/docs/toolkit/operators"}},l={},u=[{value:"Custom Function",id:"custom-function",level:3}],c={toc:u},p="wrapper";function d(e){let{components:n,...r}=e;return(0,o.yg)(p,(0,a.A)({},c,r,{components:n,mdxType:"MDXLayout"}),(0,o.yg)("h1",{id:"system-functions"},"System Functions"),(0,o.yg)("p",null,(0,o.yg)("img",{alt:"System Functions",src:t(1583).A,width:"1890",height:"354"}),"\nSystem functions provide the ability to include functionality in their language that would not be easy to implement\nwithin the language itself. It does this by deferring calls to the underlying language (Java). Let's look at an example\nof a default function provided in the LARF framework to print to the console:"),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-java"},"public class PrintFunction implements SystemFunction {\n    @Override\n    public boolean isMatch(String name) {\n        return name.equalsIgnoreCase(\"PRINT\");\n    }\n\n    @Override\n    public Token<?> execute(LARFConfig config, List<Token<?>> values) {\n        if (values.size() == 2) {\n            throw new ParserException(\"PRINT expects 1 or 3 or more parameters. Either a value to print e.g. PRINT('test') \" +\n                    \"or with the delimiter used to join values as the firs parameter e.g. PRINT(' ','hello','world'\");\n        }\n        if (values.size() == 1) {\n            System.out.println(values.get(0).toSimpleString());\n        } else {\n            String formatted = values.subList(1,values.size()).stream()\n                    .map(Token::getValue)\n                    .map(Object::toString)\n                    .collect(Collectors.joining(values.get(0).getValue(String.class)));\n            System.out.println(formatted);\n        }\n        return new NullToken();\n    }\n}\n")),(0,o.yg)("p",null,"We can see that the PrintFunction extends a class called ",(0,o.yg)("inlineCode",{parentName:"p"},"SystemFunction"),". This interface defines two methods which\nare ",(0,o.yg)("inlineCode",{parentName:"p"},"isMatch")," and ",(0,o.yg)("inlineCode",{parentName:"p"},"execute"),". The first is used to associate a name with the code so that it can be called from\nwithin the language. When calling in the language, we preface our function name with ",(0,o.yg)("inlineCode",{parentName:"p"},"sys:"),", so for the above we\nwould use ",(0,o.yg)("inlineCode",{parentName:"p"},"sys:print")," or ",(0,o.yg)("inlineCode",{parentName:"p"},"sys:PRINT")," as it is case insensitive."),(0,o.yg)("p",null,"The second method is where the logic will go which gets executed when that function is called. You'll notice that\nthe config and a list of values are called. These values are the parameters that were passed to the function in the\nlanguage. As such, if we wrote ",(0,o.yg)("inlineCode",{parentName:"p"},"sys:print('hello world')"),", there would only be a simple String token value in the\nlist of values. The above method has two modes which are to accept a single value to print out to the console, or\nalternatively accept multiple where the first parameter becomes a delimiter. For example, ",(0,o.yg)("inlineCode",{parentName:"p"},"sys:print(',','bob','mary')"),"\nwould print out to the console in the language ",(0,o.yg)("inlineCode",{parentName:"p"},"bob,mary"),"."),(0,o.yg)("p",null,"You can return values from our function, but in the above situation we are not and instead return a null. As this is\nan in-built function, it is already configured and available to use. Here are some examples of this in the language runner:"),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre"},"Language Test Utility\n=====================\nsys:print('hello world')\n'hello world'\nResult: null (Type: Null, Time taken: 11ms)\nsys:print(',','mary','bob')\nmary,bob\nResult: null (Type: Null, Time taken: 1ms)\nsys:print(' ','the','sheep','jumped','over','the','moon')\nthe sheep jumped over the moon\nResult: null (Type: Null, Time taken: 1ms)\n")),(0,o.yg)("p",null,"System functions provide a bridge between the LARF language and LARF's native language (Java). Because they support\nreturning values, it means we can use the result of that code within our own languages."),(0,o.yg)("admonition",{title:"Not to be confused...",type:"tip"},(0,o.yg)("p",{parentName:"admonition"},"System functions should not be confused with functions that you can add support for in your own languages. Functions\nare a fairly advanced feature though, so system functions are there to provide system-level functionality or to be\nused as a stand-in until your language has progressed.")),(0,o.yg)("h3",{id:"custom-function"},"Custom Function"),(0,o.yg)("p",null,"Let's take a look at creating a function to create random numbers:"),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-java"},'public class RandomFunction implements Function {\n\n    @Override\n    public String getName() {\n        return "rand";\n    }\n\n    @Override\n    public Token<?> execute(SLOPConfig config, List<Token<?>> values) {\n        Random random = new Random();\n        if (values.size() < 1 || values.size() > 2) {\n            throw new ParserException("Expected two arguments e.g. \'RAND(\'integer\', 1000)\'");\n        }\n        if (!(values.get(0).getValue() instanceof String)) {\n            throw new ParserException("Expected random type (param 0) to be a String value. " +\n                    "Valid values are: \'integer\', \'double\', \'float\', \'long\', \'boolean\'");\n        }\n        String type = values.get(0).getValue(String.class);\n        if (values.size() == 2) {\n            if (!type.equalsIgnoreCase("integer")) {\n                throw new ParserException("Bound only supported when using the integer type");\n            }\n            if (values.get(1).getValue() instanceof Integer) {\n                throw new ParserException("The bound parameter must be specified as an integer");\n            }\n        }\n        switch (type) {\n            case "integer": return new TokenValue(values.size() == 1 ? random.nextInt() :\n                random.nextInt(values.get(1).getValue(Integer.class)));\n            case "float": return new TokenValue(random.nextFloat());\n            case "double": return new TokenValue(random.nextDouble());\n            case "boolean": return new TokenValue(random.nextBoolean());\n            case "long": return new TokenValue(random.nextLong());\n        }\n        throw new ParserException(\n                String.format("Unexpected type provided in random function \'%s\'", type));\n    }\n}\n')),(0,o.yg)("p",null,"Functions are simple from a code standpoint as they require to only implement the Function interface and methods.\nThe above will provide the ability to create random numbers using a type parameter to be used in an expression.\nIt is important when creating functions to check and throw errors if the parameter list is not in the expected\nformat. The code itself is fairly self-explanatory and will allow it to be called by using the ",(0,o.yg)("inlineCode",{parentName:"p"},"rand")," name and two\nparameters (the second being restricted on the type). Next we need to add it to our config:"),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-java"},"@Override\nprotected void initFunctions() {\n    addFunction(new RandomFunction());\n}\n")),(0,o.yg)("p",null,"Finally we are ready to test it out. It can be useful to test any SLOP changes by using the SLOPRunner class in the\ntest package. This allows expressions to typed in and evaluated after the enter key is pressed. Here is some output\nfor our new function:"),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-bash"},'> rand("integer")\nResult: 13788106 (Time taken: 3ms)\n> rand("integer",1000)\nResult: 730 (Time taken: 5ms)\n> rand("integer",100)\nResult: 55 (Time taken: 2ms)\n> rand("boolean")\nResult: true (Time taken: 2ms)\n> rand("boolean")\nResult: false (Time taken: 2ms)\n> rand("float")\nResult: 0.5708346 (Time taken: 2ms)\n> rand("long")\nResult: -7999691372481956837 (Time taken: 1ms)\n')),(0,o.yg)("p",null,"Functions can then be used in conjunction with other values to trigger an action or resolve a value:"),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre"},'> 3.1459 * rand("float")\nResult: 0.20246804 (Time taken: 1ms)\n')),(0,o.yg)("p",null,"Although this is just an example, it shows that we can leverage the underlying native language to fulfill either\nshortfalls in what is possible with the included literals and statements or to avoid overly complex expressions.\nImagine a banking application where we have customers stored on a database. We could setup a custom notification\nstored on a record that is associated with a specific customer which is triggered each day or whenever a change\nis made to their account. The following will notify them if their main account falls below \xa3250 and it's still\nless than or equal to the 15th of each month:"),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre"},'customer.mainAccount.total < 250.00 and DAY("LTE", 15) ? EMAIL_WARNING(customer) : null\n')))}d.isMDXComponent=!0},1583:(e,n,t)=>{t.d(n,{A:()=>a});const a=t.p+"assets/images/sys-functions-f70751c4b4c34e9c7dde67aa7fa6af67.jpg"}}]);